{"componentChunkName":"component---src-templates-blog-post-js","path":"/webauthn/part-3-web-authentication-api/","webpackCompilationHash":"c51d9b97ee0cc7feb37e","result":{"data":{"site":{"siteMetadata":{"title":"Six of one","author":"Ben Lowry"}},"markdownRemark":{"id":"0c95dcb4-bd01-5c7c-a70e-e9f3b21375d4","excerpt":"Other posts in this series: Forget your passwords with the Web Authentication API The problem with passwords Making auth better In the previous post, we‚Ä¶","html":"<p>Other posts in this series:</p>\n<ul>\n<li><a href=\"../part-1-forget-your-passwords\">Forget your passwords with the Web Authentication API</a></li>\n<li><a href=\"../part-2-the-problem-with-passwords\">The problem with passwords</a></li>\n<li><a href=\"../part-4-making-auth-better\">Making auth better</a></li>\n</ul>\n<hr>\n<p>In the previous post, we explored some problems with passwords.\nThere is a growing movement towards removing passwords and providing alternatives.\nSome of these are being enabled in browsers through the Web Authentication API.</p>\n<h2>What is WebAuthn?</h2>\n<p>WebAuthn is a specification in the <abbr title=\"World Wide Web Consortium\">W3C</abbr>.\nThe primary contributors are Mozilla, Microsoft, Google, FIDO Alliance and the W3C.</p>\n<p>It defines a standard by which browsers can get assertions from authenticators,\nand how web servers can validate those assertions.\nIt also defines a JavaScript API for web applications to request credentials from the browser.</p>\n<p>The Web Authentication API, combined with the Client-to-Authenticator Protocol (CTAP),\nmake up the FIDO2 protocol.</p>\n<h2>How does it work?</h2>\n<p>Using a device called an authenticator</p>\n<ul>\n<li>a separate device, known as an external, cross-platform or roaming authenticator</li>\n<li>built in to a phone or laptop, known as an internal, platform or bound authenticator</li>\n</ul>\n<p>What gets sent from the server to your device</p>\n<ul>\n<li>a ‚Äúchallenge‚Äù for the authenticator to sign using its private key</li>\n<li>(optionally) more configuration options for the authentication process</li>\n</ul>\n<p>What gets sent from your device to the server</p>\n<ul>\n<li>\n<p>for registering credentials:</p>\n<ul>\n<li>credential ID</li>\n<li>public key</li>\n<li>signed challenge (for server to verify using the public key)</li>\n<li>website information (origin and an identifier)</li>\n<li>authenticator type</li>\n<li>attestation statement (details about the authenticator)</li>\n</ul>\n</li>\n<li>\n<p>for getting credentials</p>\n<ul>\n<li>credential ID</li>\n<li>signed challenge</li>\n<li>website information (origin and an identifier)</li>\n<li>details about authentication (e.g. whether ‚Äúuser verification‚Äù happened)</li>\n</ul>\n</li>\n</ul>\n<p>You may have noticed that we never send anything secret like a password or personally identifiable.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 33.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAABJ0AAASdAHeZh94AAABIElEQVQY05WQMY6CQBSGJ2LJCSw4Aj2FjSUVJ/ASFB7BA6wNjTR0JLBIgwUUBkwgumFJDC4QAgksJJJY2SDgPjGx0Gq/4s/Mm/nnzfvR7T90XQfaNM1jgQRBEEXxs6eqKii1XVdfLt5iYc/n/n7f9p7r9QpHRVGkafrwA2g8HjMMM51OaZrWdf1ubhq4KE0mH6MRx3FdD9TLsiQIAsfx2WwWBMG983a7TZLE8zxN02zbhlIYRbHvf6/XP5vNbxhGcXw+n3e7HUmSCCEMw0ApisrzHEmSJMuyZVk8z5umCZ9xHMeFx45H93D4cl3Ynk6n5XIJnsFgADocDkFZlkWqquo9iqJkWfZM5SWkuq4Nw4A2Ss9qtYIp0Hue7RvPsV/4A4UBTXKOMoEGAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"no secrets\" title=\"no secrets\" src=\"/static/39b13230930c4dc34542f0adf6c64953/b9e4f/no-secrets.png\" srcset=\"/static/39b13230930c4dc34542f0adf6c64953/cf440/no-secrets.png 148w,\n/static/39b13230930c4dc34542f0adf6c64953/d2d38/no-secrets.png 295w,\n/static/39b13230930c4dc34542f0adf6c64953/b9e4f/no-secrets.png 590w,\n/static/39b13230930c4dc34542f0adf6c64953/f9b6a/no-secrets.png 885w,\n/static/39b13230930c4dc34542f0adf6c64953/267a8/no-secrets.png 921w\" sizes=\"(max-width: 590px) 100vw, 590px\" loading=\"lazy\">\n    </span>\n<p>The authenticator can store credential information for each login you‚Äôd like to use</p>\n<ul>\n<li>website identifier</li>\n<li>user identifier</li>\n<li>credential identifier</li>\n</ul>\n<!-- Some authenticators store the _actual_ private key for the credential source,\nin this case they are referred to as **resident keys**, because they are resident on the authenticator.\nAuthenticators that support resident keys can only store a limited number -- because they have to physically store something, and storage is limited. The Yubikey 5C, for example, can store 25 resident keys.\n\nAuthenticators can hold an unlimited number of **non-resident keys** -- because nothing is stored on the device.\nThat might sound strange, but this actually works by encrypting the _credential_ private key using the private key baked in to the _device_ during manufacturing, and sending that to the client (browser, app, etc) as the credential ID.\nThat means when the application requests an assertion for any particular credential ID, the authenticator first has to decrypt the credential ID to get the private key, so that it can sign the authenticatorData.\nAs a consequence, non-resident keys cannot be used for usernameless scenarios, which we'll go into a bit further later on. -->\n<h2>Can I use it?</h2>\n<p>In a word, yes. Read on if you want more detail üòÜ</p>\n<p><a href=\"http://caniuse.com\">Can I Use</a> allows you to import data from your country,\nand also has a ‚Äúusage relative‚Äù option, which can help narrow down to your targeted users,\nor you can import actual data for your users from Google Analytics.</p>\n<script src=\"https://cdn.jsdelivr.net/gh/ireade/caniuse-embed/caniuse-embed.min.js\"></script>\n<p class=\"ciu_embed\" data-feature=\"webauthn\" data-periods=\"future_1,current,past_1\" data-accessible-colours=\"false\">\n  <a href=\"http://caniuse.com/#feat=webauthn\">\n    <picture>\n      <source type=\"image/webp\" srcset=\"https://res.cloudinary.com/ireaderinokun/image/upload/v1569250922/caniuse-embed/webauthn-2019-9-23.webp\">\n      <source type=\"image/png\" srcset=\"https://res.cloudinary.com/ireaderinokun/image/upload/v1569250922/caniuse-embed/webauthn-2019-9-23.png\">\n      <source type=\"image/jpeg\" srcset=\"https://res.cloudinary.com/ireaderinokun/image/upload/v1569250922/caniuse-embed/webauthn-2019-9-23.jpg\">\n      <img src=\"https://res.cloudinary.com/ireaderinokun/image/upload/v1569250922/caniuse-embed/webauthn-2019-9-23.png\" alt=\"Data on support for the webauthn feature across the major browsers from caniuse.com\">\n    </picture>\n  </a>\n</p>\n<p>At time of writing, it is supported in Chrome, Firefox, Edge and Safari (macOS),\nand not supported on Safari (or any other browser) on iOS.\n<strong>UPDATE: 22/12/2019: Safari iOS 13.2 has support behind a feature flag, and 13.3 is enabled by default</strong></p>\n<p>Whether someone can actually use WebAuthn depends on\nif they have an external authenticator\nor if their phone/computer can act as an authenticator.</p>\n<p>I don‚Äôt have numbers, but I‚Äôm going to guess that a very small minority own authenticator devices like a Yubikey.</p>\n<p>It‚Äôs more likely that someone will have a phone/computer that is capable:</p>\n<ul>\n<li>‚úÖ Android phone from Android 7 and above (<a href=\"https://developer.android.com/about/dashboards?hl=en\">~58% of Android phones</a>)</li>\n<li>‚úÖ Windows 10 device capable of Windows Hello ‚Äî <span role=\"img\" alt=\"Note\">‚Ñπ</span> some devices are capable of using Windows Hello with a PIN, so you may not need a computer with a fingerprint scanner or an infra-red camera.</li>\n<li>‚úÖ macOS device with Face ID or Touch ID</li>\n<li>‚ùå unfortunately, it‚Äôs not supported on iOS yet. <strong>UPDATE 22/12/2019: Coming soon! experimental in iOS 13.2 and enabled in iOS 13.3</strong></li>\n</ul>\n<p>The lack of support on some devices doesn‚Äôt need to hold you back, though. You can detect support in the browser and provide different experiences for users on devices without those capabilities, without taking anything away.</p>\n<h2>How do I use the JavaScript API?</h2>\n<p>The JavaScript API only has a few methods.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// feature detection for WebAuthn</span>\nwindow<span class=\"token punctuation\">.</span>PublicKeyCredential\n\n<span class=\"token comment\">// detection for platform/on-device authenticator</span>\n<span class=\"token keyword\">await</span> window<span class=\"token punctuation\">.</span>PublicKeyCredential<span class=\"token punctuation\">.</span><span class=\"token function\">isUserVerifyingPlatformAuthenticatorAvailable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// registration of authenticator</span>\n<span class=\"token keyword\">await</span> window<span class=\"token punctuation\">.</span>navigator<span class=\"token punctuation\">.</span>credentials<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// authenticate with authenticator</span>\n<span class=\"token keyword\">await</span> window<span class=\"token punctuation\">.</span>navigator<span class=\"token punctuation\">.</span>credentials<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">)</span></code></pre></div>\n<p>If you‚Äôre wondering about those <code class=\"language-text\">options</code> parameters,\n<a href=\"https://webauthn.guide/\">webauthn.guide by Duo</a> does a much better job explaining them than I would.</p>\n<p>In the next post, we‚Äôll look at how the user experience changes,\nand how you might start enabling this for your users.</p>","frontmatter":{"title":"The Web Authentication API","date":"December 22, 2019","description":"There is a growing movement towards removing passwords and providing alternatives. Some of these are being enabled in browsers through the Web Authentication API, which we will explore in the third post in a series on WebAuthn."},"fields":{"readingTime":{"text":"5 min read"}}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/webauthn/part-3-web-authentication-api/","previous":{"fields":{"slug":"/webauthn/part-2-the-problem-with-passwords/"},"frontmatter":{"title":"The problem with passwords"}},"next":{"fields":{"slug":"/webauthn/part-4-making-auth-better/"},"frontmatter":{"title":"Making auth better"}}}}}